/* SQL Manager for InterBase and Firebird 5.5.4.52620                                   */
/* ------------------------------------------------------------------------------------ */
/* Host     : localhost                                                                 */
/* Database : C:\USERS\ACER\DESKTOP\PROJETOS ESTUDOS\POSTOABC\BIN\DATABASE\POSTOABC.FDB */


CREATE DATABASE 'C:\POSTOABC\BIN\DATABASE\POSTOABC.FDB'
  USER 'SYSDBA'
  PAGE_SIZE = 8192
  DEFAULT CHARACTER SET WIN1252
  COLLATION WIN1252;

/* Definition for the `GEN_ABASTECIMENTOS` generator :  */

CREATE GENERATOR GEN_ABASTECIMENTOS;

/* Definition for the `GEN_BOMBAS` generator :  */

CREATE GENERATOR GEN_BOMBAS;

/* Definition for the `GEN_ID_TANQUE` generator :  */

CREATE GENERATOR GEN_ID_TANQUE;

/* Structure for the `ABASTECIMENTOS` table :  */

CREATE TABLE ABASTECIMENTOS (
  ID INTEGER NOT NULL,
  DATA_ABASTECIMENTO DATE DEFAULT CURRENT_TIMESTAMP NOT NULL,
  VALOR_LITRO NUMERIC(12, 3) NOT NULL,
  QUANTIDADE_LITROS NUMERIC(12, 3),
  IMPOSTO NUMERIC(12, 2),
  VALOR_ABASTECIMENTO NUMERIC(12, 3),
  ID_BOMBA INTEGER NOT NULL);


ALTER TABLE ABASTECIMENTOS ADD PRIMARY KEY (ID);

/* Structure for the `BOMBAS` table :  */

CREATE TABLE BOMBAS (
  ID INTEGER NOT NULL,
  IDENTIFICACAO_BOMBA VARCHAR(255) NOT NULL,
  VALOR_LITRO NUMERIC(12, 3) NOT NULL,
  ID_TANQUE INTEGER NOT NULL);


ALTER TABLE BOMBAS ADD PRIMARY KEY (ID);

/* Structure for the `TANQUES` table :  */

CREATE TABLE TANQUES (
  ID INTEGER NOT NULL,
  NUMERO_TANQUE INTEGER NOT NULL,
  CAPACIDADE_TANQUE NUMERIC(12, 2) NOT NULL);


ALTER TABLE TANQUES ADD PRIMARY KEY (ID);

/* Structure for the `ABASTECIMENTOS` table :  */

ALTER TABLE ABASTECIMENTOS ADD CONSTRAINT FK_ABASTECIMENTOS FOREIGN KEY (ID_BOMBA) REFERENCES BOMBAS(ID);

/* Structure for the `BOMBAS` table :  */

ALTER TABLE BOMBAS ADD CONSTRAINT FK_BOMBAS FOREIGN KEY (ID_TANQUE) REFERENCES TANQUES(ID);

/* Definition for the `BI_TANQUES_ID` trigger :  */

SET TERM ^ ;

CREATE TRIGGER BI_TANQUES_ID FOR TANQUES
ACTIVE BEFORE 
  INSERT
POSITION 0
AS
BEGIN
  IF (NEW.ID IS NULL) THEN
      NEW.ID = GEN_ID(GEN_ID_TANQUE, 1);
END^

SET TERM ; ^

/* Definition for the `TG_ABASTECIMENTOS_ID` trigger :  */

SET TERM ^ ;

CREATE TRIGGER TG_ABASTECIMENTOS_ID FOR ABASTECIMENTOS
ACTIVE BEFORE 
  INSERT
POSITION 0
AS
BEGIN
  IF (NEW.ID IS NULL) THEN
      NEW.ID = GEN_ID(GEN_ABASTECIMENTOS, 1);
END^

SET TERM ; ^

/* Definition for the `TG_BOMBAS_ID` trigger :  */

SET TERM ^ ;

CREATE TRIGGER TG_BOMBAS_ID FOR BOMBAS
ACTIVE BEFORE 
  INSERT
POSITION 0
AS
BEGIN
  IF (NEW.ID IS NULL) THEN
      NEW.ID = GEN_ID(GEN_BOMBAS, 1);
END^

SET TERM ; ^

/* Privileges for the `ABASTECIMENTOS` :  */


GRANT SELECT, INSERT, DELETE, REFERENCES, UPDATE ON ABASTECIMENTOS TO SYSDBA WITH GRANT OPTION;


/* Privileges for the `BOMBAS` :  */


GRANT SELECT, INSERT, DELETE, REFERENCES, UPDATE ON BOMBAS TO SYSDBA WITH GRANT OPTION;


/* Privileges for the `TANQUES` :  */


GRANT SELECT, INSERT, DELETE, REFERENCES, UPDATE ON TANQUES TO SYSDBA WITH GRANT OPTION;

